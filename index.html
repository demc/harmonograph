<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF8">

    <style>

      html, body {
        font-family: courier;
        font-size: 12px;
      }

      h1 {
        font-size: 16px;
      }

      canvas {
        border: 1px solid black;
      }

      label {
        display: inline-block;
        width: 175px;
      }

      input {
        width: 40px;
      }

      ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

    </style>
  </head>
  <body>
    <h1>1 Dimensional Pendular Motion</h1>

    <canvas id="p" width="400" height="500"></canvas>

    <ul>
      <li>
        <label for="frequency">Frequency (radians)</label>
        <input type="number" id="frequency" step="0.25" value="1.0" />
      </li>
      <li>
        <label>Phase Shift (radians)</label>
        <input type="number" id="phase-shift" step="0.25" value="0.5" />
      </li>
      <li>
        <label>Amplitude (pixels)</label>
        <input type="number" id="amplitude" step="10" value="100" />
      </li>
      <li>
        <button id="pause">Pause</button>
      </li>
    </ul>

    <script src="harmonograph.js"></script>
    <script>
      let p = document.getElementById('p');
      let ctx = p.getContext('2d');
      let scene = new Scene(ctx, 400, 500);
      let pendulumDial = new PendulumDial(scene, 20, 25, 360, 10, 100, Math.PI);
      let penulum1D = new Pendulum1D(scene, 20, 50, 360, 180, 100, Math.PI);
      let unitCircle = new UnitCircle(scene, 200, 350, 100, Math.PI);
      let sineWave = new SineWave(scene, 20, 300, 180, 100, 100, Math.PI);

      scene.start();

      const pauseButton = document.getElementById('pause');
      pauseButton.addEventListener('click', (e) => {
        if (scene.playing) {
          scene.stop();
          pauseButton.textContent = 'Resume';
        } else {
          scene.start();
          pauseButton.textContent = 'Pause';
        }
      });

      const frequencyInput = document.getElementById('frequency');
      const phaseShiftInput = document.getElementById('phase-shift');
      const amplitudeInput = document.getElementById('amplitude');

      frequencyInput.addEventListener(
        'input',
        createInputHandler(
          frequencyInput,
          [pendulumDial, unitCircle, penulum1D, sineWave],
          'setFrequency',
          Math.PI
        )
      );

      phaseShiftInput.addEventListener(
        'input',
        createInputHandler(
          phaseShiftInput,
          [pendulumDial, unitCircle, penulum1D, sineWave],
          'setPhaseShift',
          Math.PI
        )
      );

      amplitudeInput.addEventListener(
        'input',
        createInputHandler(
          amplitudeInput,
          [pendulumDial, unitCircle, penulum1D, sineWave],
          'setAmplitude'
        )
      );

      function createInputHandler(input, components, methodName, multiplier) {
        return (e) => {
          let value = parseFloat(e.target.value);

          if (isFinite(value)) {
            scene.reset();

            if (isFinite(multiplier)) {
              value = value * multiplier;
            }
            
            components.forEach(component => component[methodName](value));
          }
        };
      }
    </script>
  </body>
</html>
